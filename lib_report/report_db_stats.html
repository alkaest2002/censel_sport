{% extends "_base.html" %}

{% block style %}
<style>
    table tr th {
        padding: 6px;
    }

    table tr td {
        padding: 3px;
    }
</style>
{% endblock %}

{% block body %}
<!-- FIRST PAGE -->
<div class="page">
    <div class="content">
        <div>
            <!-- Page Header -->
            <div class="mb-xxl">
                <div class="header">
                    <h1 class="mb-xs">DATASET CENTRO DI SELEZIONE</h1>
                    <p>Allegato {{ header }}</p>
                </div>
            </div>

            <!-- Page Content -->
            <div>
                {% for dataset in data %}
                <div class="mb-xs">{% if loop.first%}Dati Accademia{% else %}Dati Marescialli{% endif %}</div>
                <table class="table-bordered full-width mb-xl">
                    <thead>
                        <tr>
                            <th class="text-center">Prova sportiva</th>
                            <th class="text-center" style="width: 10%;">Anni</th>
                            <th class="text-center" style="width: 10%;">M</th>
                            <th class="text-center" style="width: 10%;">F</th>
                            <th class="text-center" style="width: 10%;">Età: 17-23</th>
                            <th class="text-center" style="width: 10%;">Età: 24-29</th>
                            <th class="text-center" style="width: 10%;">Totale</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% set current_test = "" %}
                        {% for test, test_data in dataset.to_dict('records') | groupby('test') %}
                            {% set parent_loop = loop %}
                            {% for row in test_data %}
                                <tr {% if loop.last and not parent_loop.last %}style="border-bottom:1px dotted #888"{% endif %}>
                                    {% if loop.first  %}
                                        <td class="text-center" rowspan="{{ test_data | length }}">{{ get_test_label(test) }}</td>
                                    {% endif %}
                                    <td class="text-center">{{ row.recruitment_year }}</td>
                                    <td class="text-center">{{ row.M | int }}</td>
                                    <td class="text-center">{{ row.F | int }}</td>
                                    <td class="text-center">{{ row["17-23"] | int }}</td>
                                    <td class="text-center">{{ row["24-29"] | int }}</td>
                                    <td class="text-center">{{ row.total_count | int }}</td>
                                </tr>
                            {% endfor %}
                        {% endfor %}
                    </tbody>
                    {% if loop.last %}
                        <tfoot>
                            <tr>
                                <td colspan="4">
                                    <div class="caption">
                                        <span>Tabella {{ header }}.1:</span>
                                        <span>
                                            Il dataset analizzato è quello originale, prima dell'applicaizone dei due <span class="text-italic">loop</span> di analisi.
                                        </span>
                                    </div>
                                </td>
                            </tr>
                        </tfoot>
                    {% endif %}
                </table>
                {% endfor%}
            </div>
        </div>
        <div class="footer">{{ page }}</div>
    </div>
</div>
{% endblock %}