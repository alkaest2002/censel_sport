{% extends "_base.html" %}

{% block style %}
<style>
    table tr th {
        padding: 6px;
    }

    table tr td {
        padding: 3px;
    }
</style>
{% endblock %}

{% block body %}
<!-- FIRST PAGE -->
<div class="page">
    <div class="content">
        <div>
            <!-- Page Header -->
            <div class="mb-xxl">
                <div class="header">
                    <h1 class="mb-xs">DATASET CENTRO DI SELEZIONE</h1>
                    <p>Allegato {{ header }}</p>
                </div>
            </div>

            <!-- Page Content -->
            <h2 class="mb-xl">Composizione del dataset</h2>
            {% for key_col in data.keys() %}
                <div class="mb-xxl">
                    <table class="table-bordered full-width">
                        <tbody>
                            <tr>
                                <th class="text-center" style="width: 200px;">Prova sportiva</th>
                                <th class="text-center" style="width: 200px;">Anni</th>
                                <th class="text-center">{{ key_col }}</th>
                                <th class="text-center" style="width: 200px;">Totale</th>
                            </tr>
                        </tbody>
                        {% set current_test = "" %}
                        {% for test, test_data in data[key_col] | groupby('test') %}
                            {% set parent_loop = loop %}
                            {% for row in test_data %}
                                <tr {% if loop.last and not parent_loop.last %}style="border-bottom:1px dotted #888"{% endif %}>
                                    {% if loop.first  %}
                                        <td class="text-center" rowspan="{{ test_data | length }}">{{ test }}</td>
                                    {% endif %}
                                    <td class="text-center">{{ row.recruitment_year }}</td>
                                    <td class="text-center">{{ row[key_col] | safe }}</td>
                                    <td class="text-center">{{ row.counts }}</td>
                                </tr>
                            {% endfor %}
                        {% endfor %}
                    </table>
                </div>
            {% endfor %}
        </div>
        <div class="footer">{{ page }}</div>
    </div>
</div>
{% endblock %}